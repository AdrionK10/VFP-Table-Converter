PRIVATE ALL LIKE wPICK*
STORE SET('TALK') TO wPICKTALK 
 
IF EMPTY(DBF())
	 RETURN
ELSE
 SET TALK OFF

  IF TYPE('aDBFTAGS')!='U'
   RELEASE aDBFTAGS
  ENDIF
  PUBLIC aDBFTAGS
	DIMENSION aDBFTAGS(256,2)
	
		aDBFTAGS(1)='RECORD #'
	  aDBFTAGS(2)='NORMAL ORDER'
		wPICK='RECORD #'
	
	IF EMPTY(ORDER())
		wPICK='RECORD #'
	ELSE
		wPICK=ALLTRIM(ORDER())
	ENDIF
	
	FOR iPICK= 2 TO 256
		IF EMPTY(TAG(iPICK-1))
			iPICK=iPICK-1
			DIMENSION aDBFTAGS(iPICK,2)
			EXIT
		ELSE
			aDBFTAGS(iPICK,1)=TAG(iPICK-1)
			aDBFTAGS(iPICK,2)=KEY(iPICK-1)
		ENDIF
	ENDFOR
ENDIF 						
	
IF WEXIST('wPICKTAG')
 RELEASE WINDOW wPICKTAG
ENDIF
	 DEFINE WINDOW wPICKTAG FROM 05,11 TO (05+iPICK+7),68;
	 COLOR SCHEME iPICK+5;
	 SHADOW;
	 NOFLOAT;
	 TITLE ' PICK AN INDEX ORDER FOR "'+ALIAS()+'.DBF" ';
	 DOUBLE
	ACTIVATE WINDOW wPICKTAG TOP
	
	wPICKROW=3 	
	iPICKROWS=ALEN(aDBFTAGS,1)
	iPICK4=1
	@ 2,3 SAY ''
	FOR iPICK3=1 TO iPICKROWS
	 @ wPICKROW,27 SAY aDBFTAGS[iPICK4,2];
	 SIZE 1,27
   
	iPICK4=iPICK4+1
	wPICKROW=wPICKROW+1 
	ENDFOR
	
	@ 02,01 GET wPICK;
		FROM aDBFTAGS;
		SIZE (iPICK+2),25;
		COLOR W/R+
	READ 
	
	IF READKEY()=12	OR READKEY()=	268		&& WAS ESC PRESSED TO TERM "READ"?
	 CLEAR READ
	ELSE	
		IF wPICK='RECORD #'
		 SET ORDER TO
		ELSE
		 SET ORDER TO &wPICK
		 STORE wPICK TO _CLIPTEXT
		ENDIF
	ENDIF
	
DO CASE 
   CASE RECCOUNT() = 0
   	GO TOP
   CASE EOF()
    GO BOTTOM
   OTHERWISE
    GO RECNO()
ENDCASE  
	
	
*IF NOT EOF()	
* GO RECNO()
*ENDIF

RELEASE WINDOW wPICKTAG
RELEASE aDBFTAGS
SET TALK &wPICKTALK

RETURN
